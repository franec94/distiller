version: 1
pruners:

  mid_pruner_1:
    class:  AutomatedGradualPruner
    initial_sparsity : 0.05
    final_sparsity: 0.25
    weights: [module.net.1.linear.weight]

  mid_pruner_2:
    class:  AutomatedGradualPruner
    initial_sparsity : 0.05
    final_sparsity: 0.30
    weights: [module.net.2.linear.weight,
      module.net.3.linear.weight,
      module.net.4.linear.weight]

  mid_pruner_3:
    class:  AutomatedGradualPruner
    initial_sparsity : 0.05
    final_sparsity: 0.50
    weights: [module.net.5.linear.weight]

lr_schedulers:
  # Learning rate decay scheduler
   pruning_lr:
     class: ReduceLROnPlateau
     verbose: True

policies:

  - pruner:
      instance_name : mid_pruner_1
    starting_epoch: 300024
    ending_epoch: 334999
    frequency: 2
  
  - pruner:
      instance_name : mid_pruner_2
    starting_epoch: 300024
    ending_epoch: 334999
    frequency: 2

  - pruner:
      instance_name : mid_pruner_3
    starting_epoch: 300024
    ending_epoch: 334999
    frequency: 2

  - lr_scheduler:
      instance_name: pruning_lr
    starting_epoch: 300024
    ending_epoch: 334999
    frequency: 1
