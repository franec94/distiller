# time python3 compress_regressor.py --lr 0.005 --train --evaluate --cuda  --n_hf N_HF --n_hl N_HL --sidelength SIDELENGTH --num_epochs EPOCHS --compress=../sensitivity-pruning/siren.schedule_sensitivity.yaml

version: 1
pruners:
  pruner1:
    class: 'SensitivityPruner'
    sensitivities:
      'module.net.0.linear.weight': 0.05
      'module.net.1.linear.weight': 0.25
      'module.net.2.linear.weight': 0.35
      'module.net.3.linear.weight': 0.40
      'module.net.4.linear.weight': 0.45
      'module.net.5.linear.weight': 0.55
      'module.net.6.weight': 0.05

lr_schedulers:
   pruning_lr:
     class: ExponentialLR
     gamma: 0.9

policies:
  - pruner:
      instance_name : 'pruner1'
    starting_epoch: 20
    ending_epoch: 200
    frequency: 2

  - lr_scheduler:
      instance_name: pruning_lr
    starting_epoch: 24
    ending_epoch: 1500
    frequency: 400
